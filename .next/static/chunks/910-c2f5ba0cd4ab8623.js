"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[910],{78500:function(e,r,a){a.d(r,{Z:function(){return c}});var t=a(57437),s=a(44839),n=a(96164);a(2265);var i=function(e){let{className:r,...a}=e;return(0,t.jsx)("div",{className:function(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return(0,n.m6)((0,s.W)(r))}("animate-pulse rounded-md bg-gray-200 dark:bg-gray-700",r),...a})};function c(){return(0,t.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden border border-gray-100 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 p-4",children:[(0,t.jsx)(i,{className:"w-12 h-12 rounded-full flex-shrink-0"}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)(i,{className:"h-4 w-1/3"}),(0,t.jsx)(i,{className:"h-3 w-1/4"})]})]}),(0,t.jsxs)("div",{className:"px-4 pb-4 space-y-2",children:[(0,t.jsx)(i,{className:"h-4 w-full"}),(0,t.jsx)(i,{className:"h-4 w-5/6"})]}),(0,t.jsx)(i,{className:"w-full h-48"}),(0,t.jsxs)("div",{className:"px-4 py-2 border-t border-gray-100 dark:border-gray-700 flex items-center justify-between",children:[(0,t.jsx)(i,{className:"h-4 w-1/4"}),(0,t.jsx)(i,{className:"h-4 w-1/3"})]}),(0,t.jsxs)("div",{className:"px-4 py-3 border-t border-gray-100 dark:border-gray-700 flex items-center justify-around gap-2",children:[(0,t.jsx)(i,{className:"h-8 w-1/3"}),(0,t.jsx)(i,{className:"h-8 w-1/3"}),(0,t.jsx)(i,{className:"h-8 w-1/3"})]})]})}},30910:function(e,r,a){a.d(r,{default:function(){return k}});var t=a(57437),s=a(34446),n=a(21513),i=a(2265),c=a(45188),l=a(64042),o=a(17583),d=a(71510);function x(e){let{postId:r,lang:a}=e;return(0,t.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 px-4 py-4",children:(0,t.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:(0,t.jsxs)("p",{children:["Comments section for post ",r," is under construction."]})})})}var h=a(75153),m=a(78395),u=a(57477);let y="https://deadlinesco-img-election-iraq-production.up.railway.app",g="https://winter-leaf-f532.safaribosafar.workers.dev";async function p(e,r){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e3;for(let s=0;s<a;s++){try{let a=await fetch(e,r);if(a.ok||a.status>=400&&a.status<500)return a}catch(e){if(s===a-1)throw e}await new Promise(e=>setTimeout(e,t*Math.pow(2,s)))}throw Error("API request to ".concat(e," failed after ").concat(a," retries."))}async function f(e,r){let a;if(!y)throw Error("NEXT_PUBLIC_API_BASE_URL is not defined");let t="".concat(y).concat(e);try{if((a=await p(t,r)).status>=500)throw Error("Primary API server error: ".concat(a.status))}catch(s){if(console.warn("Primary API request to ".concat(t," failed: ").concat(s,". Attempting fallback.")),g){let t="".concat(g).concat(e);try{a=await p(t,r)}catch(e){throw console.error("Backup API request to ".concat(t," also failed:"),e),e}}else throw s}if(!a.ok){let e=await a.text().catch(()=>"Could not read error response body.");throw Error("API Error: ".concat(a.status," ").concat(a.statusText,". Body: ").concat(e))}let s=await a.text();return s?JSON.parse(s):{}}async function j(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f(e,{...r,headers:{"Content-Type":"application/json",...r.headers},next:{revalidate:3600}})}let b=async e=>j("/api/posts/".concat(e,"/like"),{method:"POST"});var v=a(96592);function w(e){let{post:r,lang:a}=e,[s,y]=(0,i.useState)(!1),[g,p]=(0,i.useState)(r.likes),[f,j]=(0,i.useState)(!1),w=async()=>{y(!s),p(e=>s?e-1:e+1);try{await b(r.id)}catch(e){console.error("Failed to like post. Reverting.",e),y(s),p(g),v.Am.error("Couldn't like post. Please try again.")}},N={ar:m.ar,en:u._,ku:m.ar};return(0,t.jsxs)("article",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden border border-gray-100 dark:border-gray-700",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("img",{src:r.author.avatar,alt:r.author.name,className:"w-12 h-12 rounded-full object-cover"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white",children:r.author.name}),r.author.verified&&(0,t.jsx)("svg",{className:"w-5 h-5 text-blue-500",viewBox:"0 0 24 24",fill:"currentColor",children:(0,t.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1.41 15.41L5.17 12l1.41-1.41L10.59 14.59 17.41 7.76l1.41 1.41L10.59 17.41z"})})]}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:(0,h.Q)(new Date(r.timestamp),{addSuffix:!0,locale:N[a]})})]})]}),(0,t.jsx)("button",{className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)(c.Z,{size:20})})]}),(0,t.jsx)("div",{className:"px-4 pb-4",children:(0,t.jsx)("p",{className:"text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:r.content})}),r.image&&(0,t.jsx)("img",{src:r.image,alt:"Post content",className:"w-full max-h-96 object-cover"}),(0,t.jsx)("div",{className:"px-4 py-2 border-t border-gray-100 dark:border-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,t.jsxs)("span",{children:[g.toLocaleString()," likes"]}),(0,t.jsxs)("span",{children:[r.comments," comments \xb7 ",r.shares," shares"]})]})}),(0,t.jsxs)("div",{className:"px-4 py-3 border-t border-gray-100 dark:border-gray-700 flex items-center justify-around",children:[(0,t.jsxs)(n.E.button,{whileTap:{scale:.95},onClick:w,className:"flex items-center gap-2 px-4 py-2 rounded-lg transition w-1/3 justify-center ".concat(s?"text-red-500 bg-red-50 dark:bg-red-900/20":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"),"aria-label":s?"Unlike post":"Like post",children:[(0,t.jsx)(l.Z,{size:20,fill:s?"currentColor":"none"}),(0,t.jsx)("span",{className:"font-medium",children:"Like"})]}),(0,t.jsxs)("button",{onClick:()=>j(!f),className:"flex items-center gap-2 px-4 py-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 w-1/3 justify-center","aria-expanded":f,children:[(0,t.jsx)(o.Z,{size:20}),(0,t.jsx)("span",{className:"font-medium",children:"Comment"})]}),(0,t.jsxs)("button",{className:"flex items-center gap-2 px-4 py-2 rounded-lg text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 w-1/3 justify-center",children:[(0,t.jsx)(d.Z,{size:20}),(0,t.jsx)("span",{className:"font-medium",children:"Share"})]})]}),f&&(0,t.jsx)(x,{postId:r.id,lang:a})]})}var N=a(78500);function k(e){let{lang:r,posts:a}=e;return a?0===a.length?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-gray-300 p-12 text-center dark:border-gray-600",children:[(0,t.jsx)("h3",{className:"text-xl font-medium text-gray-900 dark:text-white",children:"The feed is empty"}),(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-500 dark:text-gray-400",children:"Be the first to share something!"})]}):(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsx)(s.M,{children:a.map(e=>(0,t.jsx)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},layout:!0,children:(0,t.jsx)(w,{post:e,lang:r})},e.id))})}):(0,t.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,r)=>(0,t.jsx)(N.Z,{},r))})}}}]);